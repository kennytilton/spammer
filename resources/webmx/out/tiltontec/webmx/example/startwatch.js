// Compiled by ClojureScript 1.9.671 {}
goog.provide('tiltontec.webmx.example.startwatch');
goog.require('cljs.core');
goog.require('clojure.string');
goog.require('tiltontec.util.core');
goog.require('tiltontec.cell.core');
goog.require('tiltontec.model.core');
goog.require('tiltontec.webmx.gen');
goog.require('tiltontec.cell.synapse');

tiltontec.webmx.example.startwatch.matrix_build_BANG_ = (function tiltontec$webmx$example$startwatch$matrix_build_BANG_(){
return tiltontec.model.core.make.call(null,new cljs.core.Keyword("tiltontec.webmx.example.startwatch","startwatch","tiltontec.webmx.example.startwatch/startwatch",-66251623),new cljs.core.Keyword(null,"mx-dom","mx-dom",-1445377107),tiltontec.cell.core.make_c_formula.call(null,new cljs.core.Keyword(null,"code","code",1586293142),cljs.core.list(new cljs.core.Symbol("tiltontec.cell.base","without-c-dependency","tiltontec.cell.base/without-c-dependency",-1335265675,null),cljs.core.list(new cljs.core.Symbol("md","with-par","md/with-par",-1450243129,null),new cljs.core.Symbol(null,"me","me",1501524834,null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.list(new cljs.core.Symbol(null,"div","div",-1597244137,null),cljs.core.PersistentArrayMap.EMPTY,cljs.core.list(new cljs.core.Symbol(null,"h1","h1",-256355935,null),cljs.core.PersistentArrayMap.EMPTY,"On your mark. Get set...open your browser console."),cljs.core.list(new cljs.core.Symbol(null,"clock","clock",746230400,null)))], null))),new cljs.core.Keyword(null,"input?","input?",-1792843173),null,new cljs.core.Keyword(null,"value","value",305978217),tiltontec.cell.base.unbound,new cljs.core.Keyword(null,"rule","rule",729973257),(function (slot_c_SHARP_){
var me = tiltontec.cell.base.c_model.call(null,slot_c_SHARP_);
var cell = slot_c_SHARP_;
var slot_name = tiltontec.cell.base.c_slot.call(null,slot_c_SHARP_);
var cache = tiltontec.cell.base.c_value.call(null,slot_c_SHARP_);
var _STAR_depender_STAR_21667 = tiltontec.cell.base._STAR_depender_STAR_;
tiltontec.cell.base._STAR_depender_STAR_ = null;

try{var _STAR_par_STAR_21668 = tiltontec.model.core._STAR_par_STAR_;
tiltontec.model.core._STAR_par_STAR_ = me;

try{return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [tiltontec.webmx.gen.make_tag.call(null,"div",cljs.core.PersistentArrayMap.EMPTY,cljs.core.PersistentArrayMap.EMPTY,tiltontec.cell.core.make_c_formula.call(null,new cljs.core.Keyword(null,"code","code",1586293142),cljs.core.list(cljs.core.list(new cljs.core.Symbol("clojure.core","assert","clojure.core/assert",1581062626,null),new cljs.core.Symbol(null,"me","me",1501524834,null),"no me for cFkids"),cljs.core.list(new cljs.core.Symbol("tiltontec.model.core","the-kids","tiltontec.model.core/the-kids",-1146365346,null),cljs.core.list(new cljs.core.Symbol(null,"h1","h1",-256355935,null),cljs.core.PersistentArrayMap.EMPTY,"On your mark. Get set...open your browser console."),cljs.core.list(new cljs.core.Symbol(null,"clock","clock",746230400,null)))),new cljs.core.Keyword(null,"value","value",305978217),tiltontec.cell.base.unbound,new cljs.core.Keyword(null,"rule","rule",729973257),((function (_STAR_par_STAR_21668,_STAR_depender_STAR_21667,me,cell,slot_name,cache){
return (function (slot_c_SHARP___$1){
var me__$1 = tiltontec.cell.base.c_model.call(null,slot_c_SHARP___$1);
var cell__$1 = slot_c_SHARP___$1;
var slot_name__$1 = tiltontec.cell.base.c_slot.call(null,slot_c_SHARP___$1);
var cache__$1 = tiltontec.cell.base.c_value.call(null,slot_c_SHARP___$1);
if(cljs.core.truth_(me__$1)){
} else {
throw (new Error([cljs.core.str.cljs$core$IFn$_invoke$arity$1("Assert failed: "),cljs.core.str.cljs$core$IFn$_invoke$arity$1("no me for cFkids"),cljs.core.str.cljs$core$IFn$_invoke$arity$1("\n"),cljs.core.str.cljs$core$IFn$_invoke$arity$1("me")].join('')));
}

var _STAR_par_STAR_21669 = tiltontec.model.core._STAR_par_STAR_;
tiltontec.model.core._STAR_par_STAR_ = me__$1;

try{if(cljs.core.truth_(tiltontec.model.core._STAR_par_STAR_)){
} else {
throw (new Error("Assert failed: tiltontec.model.core/*par*"));
}

return cljs.core.doall.call(null,cljs.core.remove.call(null,cljs.core.nil_QMARK_,cljs.core.flatten.call(null,(function (){var x__7615__auto__ = tiltontec.webmx.gen.make_tag.call(null,"h1",cljs.core.PersistentArrayMap.EMPTY,cljs.core.PersistentArrayMap.EMPTY,tiltontec.cell.core.make_c_formula.call(null,new cljs.core.Keyword(null,"code","code",1586293142),cljs.core.list(cljs.core.list(new cljs.core.Symbol("clojure.core","assert","clojure.core/assert",1581062626,null),new cljs.core.Symbol(null,"me","me",1501524834,null),"no me for cFkids"),cljs.core.list(new cljs.core.Symbol("tiltontec.model.core","the-kids","tiltontec.model.core/the-kids",-1146365346,null),"On your mark. Get set...open your browser console.")),new cljs.core.Keyword(null,"value","value",305978217),tiltontec.cell.base.unbound,new cljs.core.Keyword(null,"rule","rule",729973257),((function (_STAR_par_STAR_21669,me__$1,cell__$1,slot_name__$1,cache__$1,_STAR_par_STAR_21668,_STAR_depender_STAR_21667,me,cell,slot_name,cache){
return (function (slot_c_SHARP___$2){
var me__$2 = tiltontec.cell.base.c_model.call(null,slot_c_SHARP___$2);
var cell__$2 = slot_c_SHARP___$2;
var slot_name__$2 = tiltontec.cell.base.c_slot.call(null,slot_c_SHARP___$2);
var cache__$2 = tiltontec.cell.base.c_value.call(null,slot_c_SHARP___$2);
if(cljs.core.truth_(me__$2)){
} else {
throw (new Error([cljs.core.str.cljs$core$IFn$_invoke$arity$1("Assert failed: "),cljs.core.str.cljs$core$IFn$_invoke$arity$1("no me for cFkids"),cljs.core.str.cljs$core$IFn$_invoke$arity$1("\n"),cljs.core.str.cljs$core$IFn$_invoke$arity$1("me")].join('')));
}

var _STAR_par_STAR_21671 = tiltontec.model.core._STAR_par_STAR_;
tiltontec.model.core._STAR_par_STAR_ = me__$2;

try{if(cljs.core.truth_(tiltontec.model.core._STAR_par_STAR_)){
} else {
throw (new Error("Assert failed: tiltontec.model.core/*par*"));
}

return cljs.core.doall.call(null,cljs.core.remove.call(null,cljs.core.nil_QMARK_,cljs.core.flatten.call(null,cljs.core._conj.call(null,cljs.core.List.EMPTY,"On your mark. Get set...open your browser console."))));
}finally {tiltontec.model.core._STAR_par_STAR_ = _STAR_par_STAR_21671;
}});})(_STAR_par_STAR_21669,me__$1,cell__$1,slot_name__$1,cache__$1,_STAR_par_STAR_21668,_STAR_depender_STAR_21667,me,cell,slot_name,cache))
));
return cljs.core._conj.call(null,(function (){var x__7615__auto____$1 = tiltontec.webmx.example.startwatch.clock.call(null);
return cljs.core._conj.call(null,cljs.core.List.EMPTY,x__7615__auto____$1);
})(),x__7615__auto__);
})())));
}finally {tiltontec.model.core._STAR_par_STAR_ = _STAR_par_STAR_21669;
}});})(_STAR_par_STAR_21668,_STAR_depender_STAR_21667,me,cell,slot_name,cache))
))], null);
}finally {tiltontec.model.core._STAR_par_STAR_ = _STAR_par_STAR_21668;
}}finally {tiltontec.cell.base._STAR_depender_STAR_ = _STAR_depender_STAR_21667;
}})));
});
tiltontec.webmx.example.startwatch.hits = cljs.core.atom.call(null,(0));
tiltontec.webmx.example.startwatch.start = cljs.core.atom.call(null,(0));
tiltontec.webmx.example.startwatch.maxr = cljs.core.atom.call(null,(0));
tiltontec.webmx.example.startwatch.clock = (function tiltontec$webmx$example$startwatch$clock(){
cljs.core.reset_BANG_.call(null,tiltontec.webmx.example.startwatch.hits,(0));

cljs.core.reset_BANG_.call(null,tiltontec.webmx.example.startwatch.maxr,(0));

cljs.core.reset_BANG_.call(null,tiltontec.webmx.example.startwatch.start,tiltontec.util.core.now.call(null));

return tiltontec.webmx.gen.make_tag.call(null,"div",new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"class","class",-2030961996),"example-clock",new cljs.core.Keyword(null,"tick","tick",-835886976),tiltontec.cell.core.cI.call(null,false,new cljs.core.Keyword(null,"ephemeral?","ephemeral?",-311673012),true),new cljs.core.Keyword(null,"ticker","ticker",214613162),tiltontec.cell.core.make_c_formula.call(null,new cljs.core.Keyword(null,"code","code",1586293142),cljs.core.list(cljs.core.list(new cljs.core.Symbol("js","setInterval","js/setInterval",2090002939,null),cljs.core.list(new cljs.core.Symbol(null,"fn*","fn*",-752876845,null),cljs.core.PersistentVector.EMPTY,cljs.core.list(new cljs.core.Symbol(null,"mset!>","mset!>",-1433510611,null),new cljs.core.Symbol(null,"me","me",1501524834,null),new cljs.core.Keyword(null,"tick","tick",-835886976),true)),(10))),new cljs.core.Keyword(null,"value","value",305978217),tiltontec.cell.base.unbound,new cljs.core.Keyword(null,"rule","rule",729973257),(function (slot_c_SHARP_){
var me = tiltontec.cell.base.c_model.call(null,slot_c_SHARP_);
var cell = slot_c_SHARP_;
var slot_name = tiltontec.cell.base.c_slot.call(null,slot_c_SHARP_);
var cache = tiltontec.cell.base.c_value.call(null,slot_c_SHARP_);
return setInterval(((function (me,cell,slot_name,cache){
return (function (){
return tiltontec.model.core.mset_BANG__GT_.call(null,me,new cljs.core.Keyword(null,"tick","tick",-835886976),true);
});})(me,cell,slot_name,cache))
,(10));
})),new cljs.core.Keyword(null,"content","content",15833224),tiltontec.cell.core.make_c_formula.call(null,new cljs.core.Keyword(null,"code","code",1586293142),cljs.core.list(cljs.core.list(new cljs.core.Symbol(null,"if","if",1181717262,null),cljs.core.list(new cljs.core.Symbol(null,"<mget","<mget",-285244545,null),new cljs.core.Symbol(null,"me","me",1501524834,null),new cljs.core.Keyword(null,"tick","tick",-835886976)),cljs.core.list(new cljs.core.Symbol(null,"let","let",358118826,null),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"d","d",-682293345,null),cljs.core.list(new cljs.core.Symbol("js","Date.","js/Date.",384205255,null)),new cljs.core.Symbol(null,"es","es",-822762550,null),cljs.core.list(new cljs.core.Symbol(null,"/","/",-1371932971,null),cljs.core.list(new cljs.core.Symbol(null,"-","-",-471816912,null),cljs.core.list(new cljs.core.Symbol(null,"now","now",-9994004,null)),cljs.core.list(new cljs.core.Symbol("clojure.core","deref","clojure.core/deref",188719157,null),new cljs.core.Symbol(null,"start","start",1285322546,null))),(1000))], null),cljs.core.list(new cljs.core.Symbol(null,"swap!","swap!",-655677516,null),new cljs.core.Symbol(null,"hits","hits",-479471403,null),new cljs.core.Symbol(null,"inc","inc",324505433,null)),cljs.core.list(new cljs.core.Symbol(null,"when","when",1064114221,null),cljs.core.list(new cljs.core.Symbol(null,">",">",1085014381,null),new cljs.core.Symbol(null,"es","es",-822762550,null),(1)),cljs.core.list(new cljs.core.Symbol(null,"let","let",358118826,null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"r","r",1169147337,null),cljs.core.list(new cljs.core.Symbol("Math","round","Math/round",-647918561,null),cljs.core.list(new cljs.core.Symbol(null,"/","/",-1371932971,null),cljs.core.list(new cljs.core.Symbol("clojure.core","deref","clojure.core/deref",188719157,null),new cljs.core.Symbol(null,"hits","hits",-479471403,null)),new cljs.core.Symbol(null,"es","es",-822762550,null)))], null),cljs.core.list(new cljs.core.Symbol(null,"when","when",1064114221,null),cljs.core.list(new cljs.core.Symbol(null,">",">",1085014381,null),new cljs.core.Symbol(null,"r","r",1169147337,null),cljs.core.list(new cljs.core.Symbol("clojure.core","deref","clojure.core/deref",188719157,null),new cljs.core.Symbol(null,"maxr","maxr",-1091909765,null))),cljs.core.list(new cljs.core.Symbol(null,"reset!","reset!",527275632,null),new cljs.core.Symbol(null,"maxr","maxr",-1091909765,null),new cljs.core.Symbol(null,"r","r",1169147337,null))))),cljs.core.list(new cljs.core.Symbol(null,"str","str",-1564826950,null),cljs.core.list(new cljs.core.Symbol("clojure.core","deref","clojure.core/deref",188719157,null),new cljs.core.Symbol(null,"maxr","maxr",-1091909765,null))," > ",cljs.core.list(new cljs.core.Symbol(null,"first","first",996428481,null),cljs.core.list(new cljs.core.Symbol("str","split","str/split",1040947342,null),cljs.core.list(new cljs.core.Symbol(null,".toTimeString",".toTimeString",879367720,null),new cljs.core.Symbol(null,"d","d",-682293345,null))," ")),":",cljs.core.list(new cljs.core.Symbol(null,".getUTCMilliseconds",".getUTCMilliseconds",553466378,null),new cljs.core.Symbol(null,"d","d",-682293345,null)))),"*checks watch*")),new cljs.core.Keyword(null,"value","value",305978217),tiltontec.cell.base.unbound,new cljs.core.Keyword(null,"rule","rule",729973257),(function (slot_c_SHARP_){
var me = tiltontec.cell.base.c_model.call(null,slot_c_SHARP_);
var cell = slot_c_SHARP_;
var slot_name = tiltontec.cell.base.c_slot.call(null,slot_c_SHARP_);
var cache = tiltontec.cell.base.c_value.call(null,slot_c_SHARP_);
if(cljs.core.truth_(tiltontec.model.core._LT_mget.call(null,me,new cljs.core.Keyword(null,"tick","tick",-835886976)))){
var d = (new Date());
var es = ((tiltontec.util.core.now.call(null) - cljs.core.deref.call(null,tiltontec.webmx.example.startwatch.start)) / (1000));
cljs.core.swap_BANG_.call(null,tiltontec.webmx.example.startwatch.hits,cljs.core.inc);

if((es > (1))){
var r_21672 = Math.round((cljs.core.deref.call(null,tiltontec.webmx.example.startwatch.hits) / es));
if((r_21672 > cljs.core.deref.call(null,tiltontec.webmx.example.startwatch.maxr))){
cljs.core.reset_BANG_.call(null,tiltontec.webmx.example.startwatch.maxr,r_21672);
} else {
}
} else {
}

return [cljs.core.str.cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,tiltontec.webmx.example.startwatch.maxr)),cljs.core.str.cljs$core$IFn$_invoke$arity$1(" > "),cljs.core.str.cljs$core$IFn$_invoke$arity$1(cljs.core.first.call(null,clojure.string.split.call(null,d.toTimeString()," "))),cljs.core.str.cljs$core$IFn$_invoke$arity$1(":"),cljs.core.str.cljs$core$IFn$_invoke$arity$1(d.getUTCMilliseconds())].join('');
} else {
return "*checks watch*";
}
}))], null),cljs.core.PersistentArrayMap.EMPTY,null);
});

//# sourceMappingURL=startwatch.js.map